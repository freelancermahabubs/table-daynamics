<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bank Data Table</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/53025ffb8e.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
      .submenu ul {
        display: none;
      }
      .hidden-column {
        display: none;
      }
      .sortable {
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="container mx-auto p-4">
      <h2 class="text-2xl font-bold mb-4">Bank Data Table</h2>
      <div class="w-[400px] rounded-lg mb-4 rounded-md text-center" style="border-radius: 10px">
        <ul class="flex items-center gap-2 bg-gray-400 py-2 px-1 text-white text-center justify-center">
          <li class="cursor-pointer px-2 hover:bg-black rounded-md" id="copy">Copy</li>
          <li class="cursor-pointer px-2 hover:bg-black rounded-md" id="excel">Excel</li>
          <li class="cursor-pointer px-2 hover:bg-black rounded-md" id="pdf">PDF</li>
          <li class="cursor-pointer px-2 hover:bg-black rounded-md" id="print">Print</li>
          <li class="cursor-pointer relative submenu px-2 hover:bg-black rounded-md" id="column-visibility">Column Visibility
            <ul class="bg-gray-300 text-black mt-1 rounded-md absolute mt-[8px] w-full text-left">
              <li class="px-2 py-1 cursor-pointer" data-column="sl">SL</li>
              <li class="px-2 py-1 cursor-pointer" data-column="bank">Bank</li>
              <li class="px-2 py-1 cursor-pointer" data-column="name">Name</li>
              <li class="px-2 py-1 cursor-pointer" data-column="account-type">Account Type</li>
              <li class="px-2 py-1 cursor-pointer" data-column="account-holder-name">Account Holder Name</li>
              <li class="px-2 py-1 cursor-pointer" data-column="bank-name">Bank Name</li>
              <li class="px-2 py-1 cursor-pointer" data-column="account-number">Account Number</li>
              <li class="px-2 py-1 cursor-pointer" data-column="issue-date">Issue Date</li>
              <li class="px-2 py-1 cursor-pointer" data-column="amount">Amount</li>
              <li class="px-2 py-1 cursor-pointer" data-column="cheque-no">Cheque No</li>
              <li class="px-2 py-1 cursor-pointer" data-column="data">Date</li>
              <li class="px-2 py-1 cursor-pointer" data-column="status">Status</li>
            </ul>
          </li>
        </ul>
      </div>

      <div class="text-right mb-5">
        <label for="search">Search</label>
        <input type="text" id="search" class="border border-gray-400 py-1 px-2" />
      </div>

      <div class="overflow-x-auto">
        <table id="bank-table" class="min-w-full bg-white border border-gray-300">
          <thead class="border-b border-t border-gray-400 mb-2">
            <tr>
              <th class="py-2 px-4 whitespace-nowrap text-left column-sl sortable">SL <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-bank sortable">Bank <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-name sortable">Name <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-account-type sortable">Account Type <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-account-holder-name sortable">Account Holder Name <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-bank-name sortable">Bank Name <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-account-number sortable">Account Number <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-issue-date sortable">Issue Date <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-amount sortable">Amount <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-cheque-no sortable">Cheque No <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-data sortable">Data <i class="fa-solid fa-sort-down"></i></th>
              <th class="py-2 px-4 whitespace-nowrap text-left column-status sortable">Status <i class="fa-solid fa-sort-down"></i></th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-t border-gray-400">
              <td class="py-2 px-4 whitespace-nowrap column-sl">1</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank">Padma Bank</td>
              <td class="py-2 px-4 whitespace-nowrap column-name">kabir</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-type">By Bank Account md asif</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-holder-name">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank-name">md asif</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-number">DBD</td>
              <td class="py-2 px-4 whitespace-nowrap column-issue-date">15-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-amount">516</td>
              <td class="py-2 px-4 whitespace-nowrap column-cheque-no">3530021</td>
              <td class="py-2 px-4 whitespace-nowrap column-data">01-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-status">
                <span class="bg-[#34d399] text-[#ffffff] py-[3px] px-[8px] rounded-md cursor-pointer">Completed</span>
              </td>
            </tr>

            <tr class="border-b border-t border-gray-400">
              <td class="py-2 px-4 whitespace-nowrap column-sl">2</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank">Padma Bank</td>
              <td class="py-2 px-4 whitespace-nowrap column-name">rubel</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-type">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-holder-name">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank-name">md rakib</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-number">BDBL</td>
              <td class="py-2 px-4 whitespace-nowrap column-issue-date">15-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-amount">516</td>
              <td class="py-2 px-4 whitespace-nowrap column-cheque-no">3530021</td>
              <td class="py-2 px-4 whitespace-nowrap column-data">01-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-status">
                <span class="bg-[#34d399] text-[#ffffff] py-[3px] px-[8px] rounded-md cursor-pointer">Completed</span>
              </td>
            </tr>

            <tr class="border-b border-t border-gray-400">
              <td class="py-2 px-4 whitespace-nowrap column-sl">3</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank">DBBL</td>
              <td class="py-2 px-4 whitespace-nowrap column-name">Shahidul</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-type">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-holder-name">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank-name">by bank md rahim</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-number">DBD</td>
              <td class="py-2 px-4 whitespace-nowrap column-issue-date">15-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-amount">545</td>
              <td class="py-2 px-4 whitespace-nowrap column-cheque-no">3530021</td>
              <td class="py-2 px-4 whitespace-nowrap column-data">01-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-status">
                <span class="bg-[#34d399] text-[#ffffff] py-[3px] px-[8px] rounded-md cursor-pointer">Completed</span>
              </td>
            </tr>

            <tr class="border-b border-t border-gray-400">
              <td class="py-2 px-4 whitespace-nowrap column-sl">4</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank">Padma Bank</td>
              <td class="py-2 px-4 whitespace-nowrap column-name">masum</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-type">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-holder-name">By Bank Account</td>
              <td class="py-2 px-4 whitespace-nowrap column-bank-name">md asif</td>
              <td class="py-2 px-4 whitespace-nowrap column-account-number">BDBL</td>
              <td class="py-2 px-4 whitespace-nowrap column-issue-date">15-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-amount">516</td>
              <td class="py-2 px-4 whitespace-nowrap column-cheque-no">3530021</td>
              <td class="py-2 px-4 whitespace-nowrap column-data">01-Jan-2024</td>
              <td class="py-2 px-4 whitespace-nowrap column-status">
                <span class="bg-[#34d399] text-[#ffffff] py-[3px] px-[8px] rounded-md cursor-pointer">Completed</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const bankTable = document.getElementById('bank-table');
        const copyButton = document.getElementById('copy');
        const excelButton = document.getElementById('excel');
        const pdfButton = document.getElementById('pdf');
        const printButton = document.getElementById('print');
        const searchInput = document.getElementById('search');
        const columnVisibilityButton = document.getElementById('column-visibility');
        const submenu = document.querySelector('.submenu');
        const submenuList = submenu.querySelector('ul');

        // Toggle submenu
        submenu.addEventListener('click', () => {
          submenuList.style.display = submenuList.style.display === 'none' ? 'block' : 'none';
        });

        // Hide submenu when clicking outside
        document.addEventListener('click', (event) => {
          if (!submenu.contains(event.target)) {
            submenuList.style.display = 'none';
          }
        });

        // Toggle column visibility
        submenuList.querySelectorAll('li').forEach((li) => {
          li.addEventListener('click', () => {
            const columnClass = `column-${li.getAttribute('data-column')}`;
            document.querySelectorAll(`.${columnClass}`).forEach((element) => {
              element.classList.toggle('hidden-column');
            });
          });
        });

        // Function to get visible rows data
        const getVisibleTableData = () => {
          const visibleRows = [];
          bankTable.querySelectorAll('tbody tr').forEach((row) => {
            const rowData = [];
            row.querySelectorAll('td').forEach((cell) => {
              if (!cell.classList.contains('hidden-column')) {
                rowData.push(cell.innerText);
              }
            });
            visibleRows.push(rowData);
          });
          return visibleRows;
        };

        // Copy to clipboard
        copyButton.addEventListener('click', () => {
          const visibleTableData = getVisibleTableData();
          const clipboardData = visibleTableData.map((row) => row.join('\t')).join('\n');
          navigator.clipboard.writeText(clipboardData).then(() => {
            alert('Table data copied to clipboard');
          });
        });

        // Export to Excel
        excelButton.addEventListener('click', () => {
          const visibleTableData = getVisibleTableData();
          const worksheet = XLSX.utils.aoa_to_sheet(visibleTableData);
          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
          XLSX.writeFile(workbook, 'table_data.xlsx');
        });

        // Export to PDF
        pdfButton.addEventListener('click', () => {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();
          const visibleTableData = getVisibleTableData();
          doc.autoTable({
            head: [Array.from(bankTable.querySelectorAll('thead th')).filter(th => !th.classList.contains('hidden-column')).map(th => th.innerText)],
            body: visibleTableData,
          });
          doc.save('table_data.pdf');
        });

        // Print table
        printButton.addEventListener('click', () => {
          const printWindow = window.open('', '_blank');
          const printHtml = `
            <html>
              <head>
                <title>Print Table</title>
                <style>
                  table { border-collapse: collapse; width: 100%; }
                  th, td { border: 1px solid black; padding: 8px; text-align: left; }
                  .hidden-column { display: none; }
                </style>
              </head>
              <body>
                ${bankTable.outerHTML}
              </body>
            </html>
          `;
          printWindow.document.write(printHtml);
          printWindow.document.close();
          printWindow.print();
          printWindow.close();
        });

        // Sort table
        const sortTable = (columnIndex) => {
          const rows = Array.from(bankTable.querySelectorAll('tbody tr'));
          const isAsc = bankTable.querySelectorAll('th')[columnIndex].classList.toggle('asc');
          rows.sort((a, b) => {
            const aText = a.querySelectorAll('td')[columnIndex].innerText.toLowerCase();
            const bText = b.querySelectorAll('td')[columnIndex].innerText.toLowerCase();
            return isAsc ? aText.localeCompare(bText) : bText.localeCompare(aText);
          });
          rows.forEach((row) => bankTable.querySelector('tbody').appendChild(row));
        };

        // Add sort event listeners
        bankTable.querySelectorAll('.sortable').forEach((header, index) => {
          header.addEventListener('click', () => sortTable(index));
        });

        // Search table
        searchInput.addEventListener('input', () => {
          const searchTerm = searchInput.value.toLowerCase();
          bankTable.querySelectorAll('tbody tr').forEach((row) => {
            const isMatch = Array.from(row.querySelectorAll('td')).some((cell) => {
              return cell.innerText.toLowerCase().includes(searchTerm);
            });
            row.style.display = isMatch ? '' : 'none';
          });
        });
      });
    </script>
  </body>
</html>
